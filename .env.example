# =============================================================================
# MF-Investments Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values.
# Variables marked [REQUIRED] must be set before deployment.
# Variables marked [OPTIONAL] have sensible defaults.
# =============================================================================

# ─── Server ──────────────────────────────────────────────────────────────────
PORT=4000                               # [OPTIONAL] API port (default: 4000)
NODE_ENV=production                     # [REQUIRED] production | development

# ─── Database (MySQL) ───────────────────────────────────────────────────────
DB_HOST=mysql                           # [REQUIRED] Use 'mysql' in Docker, 'localhost' for local dev
DB_PORT=3306                            # [OPTIONAL] Default MySQL port
DB_USER=mf_user                         # [REQUIRED] Database username
DB_PASSWORD=CHANGE_ME                   # [REQUIRED] Database user password (change this!)
DB_NAME=mf_selection                    # [REQUIRED] Database name
DB_ROOT_PASSWORD=CHANGE_ME              # [REQUIRED] MySQL root password (change this!)

# ─── Security ────────────────────────────────────────────────────────────────
JWT_SECRET=CHANGE_ME_GENERATE_RANDOM    # [REQUIRED] JWT signing secret (min 32 chars, generate unique!)

# ─── Redis Cache ─────────────────────────────────────────────────────────────
# Use 'redis' in Docker
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_ENABLED=true
# [VPS ONLY] Redis password. Leave empty for TrueNAS (no auth)
REDIS_PASSWORD=

# ─── Email / SMTP (Zoho Mail) ───────────────────────────────────────────────
SMTP_HOST=smtppro.zoho.in               # [REQUIRED] SMTP server hostname
SMTP_PORT=465                           # [REQUIRED] 465 (SSL) or 587 (TLS)
SMTP_USER=support@trymutualfunds.com    # [REQUIRED] SMTP username
SMTP_PASS=CHANGE_ME                     # [REQUIRED] SMTP password or app-specific password
SMTP_FROM=support@trymutualfunds.com    # [OPTIONAL] From address (defaults to SMTP_USER)

# ─── Cron Reports ───────────────────────────────────────────────────────────
ENABLE_CRON_REPORTS=true                # [OPTIONAL] Master switch for email reports
CRON_REPORT_EMAIL=your@email.com        # [REQUIRED if reports enabled] Report recipient
ENABLE_TRANSACTION_SCHEDULER_REPORT=true
ENABLE_FULL_SYNC_REPORT=true
ENABLE_AMFI_SYNC_REPORT=true
ENABLE_AMFI_SYNC_SCHEDULE=true          # [OPTIONAL] Enable scheduled AMFI sync (11 PM & 5 AM IST)

# ─── Backup ─────────────────────────────────────────────────────────────────
# [VPS ONLY] Backup file recipient email
BACKUP_EMAIL=your@email.com

# ─── MFAPI Configuration ────────────────────────────────────────────────────
MFAPI_BASE_URL=https://api.mfapi.in     # [OPTIONAL] Primary data source
MFAPI_TIMEOUT_MS=60000                  # [OPTIONAL] API timeout (ms)
CACHE_TTL_LATEST_NAV_MS=3600000         # [OPTIONAL] 1 hour
CACHE_TTL_SCHEME_DETAILS_MS=1800000     # [OPTIONAL] 30 minutes
CACHE_TTL_NAV_HISTORY_MS=21600000       # [OPTIONAL] 6 hours

# ─── Sync / Scheduler ───────────────────────────────────────────────────────
ENABLE_SCHEDULER_CRON=true              # [OPTIONAL] Enable daily SIP/SWP execution at 6 AM IST
ENABLE_FULL_SYNC=true                   # [OPTIONAL] Enable nightly full fund sync at 1 AM IST
ENABLE_INCREMENTAL_SYNC=false           # [OPTIONAL] Legacy API sync (deprecated, use AMFI instead)
ENABLE_MFAPI_FALLBACK=false             # [OPTIONAL] Fallback for non-whitelisted AMCs
MFAPI_NAV_RETENTION=30                  # [OPTIONAL] NAV records retained per fund
MFAPI_BATCH_SIZE=50                     # [OPTIONAL] Funds per batch during ingestion

# ─── Rate Limiting ──────────────────────────────────────────────────────────
RATE_LIMIT_WINDOW_MS=60000              # [OPTIONAL] Rate limit window (1 minute)
RATE_LIMIT_MAX_REQUESTS=1000            # [OPTIONAL] Max requests per window

# ─── AI / Ollama ─────────────────────────────────────────────────────────────
# [OPTIONAL] Ollama API endpoint
OLLAMA_ENDPOINT=
# [OPTIONAL] Default AI model
OLLAMA_MODEL_NAME=qwen2.5:0.5b-instruct

# ─── Ports ───────────────────────────────────────────────────────────────────
APP_PORT=4000                           # [OPTIONAL] Host port for backend
WEB_PORT=80                             # [OPTIONAL] Host port for Nginx

# ─── Monitoring (Uptime Kuma — Self-Hosted) ──────────────────────────────────
# Create "Push" type monitors in your Uptime Kuma dashboard and paste URLs here.
# Leave empty to disable monitoring pings. Works with any URL that accepts GET.
# [VPS ONLY] Push URL for SIP scheduler
KUMA_PUSH_SIP_URL=
KUMA_PUSH_FUND_SYNC_URL=
# [VPS ONLY] Push URL for AMFI NAV Sync
KUMA_PUSH_AMFI_SYNC_URL=
# [VPS ONLY] Push URL for daily backup
KUMA_PUSH_BACKUP_URL=
